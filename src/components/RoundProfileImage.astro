---
import "../styles/global.css"
import {Image} from "astro:assets";

// Props:
// - src: string | null - image URL (optional)
// - alt: string - alt text (required for accessibility)
// - size: "sm" | "md" | "lg" | number - preset sizes or custom pixel size
const { src = null, alt = "Profile picture", size = "md" } = Astro.props;

const sizes = {
    sm: "w-10 h-10 text-sm",
    md: "w-16 h-16 text-base",
    lg: "w-24 h-24 text-xl"
};

const sizeClass = typeof size === "number"
    ? ""
    : sizes[size] ?? sizes.md;
const customStyle = typeof size === "number"
    ? `width:${size}px;height:${size}px;`
    : undefined;

function initialsFromAlt(a) {
    return (a || "")
        .split(/\s+/)
        .filter(Boolean)
        .slice(0,2)
        .map(s => s[0].toUpperCase())
        .join("");
}
const initials = initialsFromAlt(alt);
---
<span style={customStyle} class={`inline-block flex items-center justify-center ${sizeClass} shadow-2xl rounded-full overflow-hidden bg-gray-200 dark:bg-gray-700 select-none`}>
  {src ? (
          <Image class="object-center object-cover w-full h-full" src={src} alt={alt} loading="eager"/>
  ) : (
          <span aria-hidden="true" class="font-semibold text-gray-700 dark:text-gray-100">
      {initials}
    </span>
  )}
</span>